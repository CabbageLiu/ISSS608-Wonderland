{
  "hash": "61125a0a8d5d43740167b792dc699520",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Exercise 1 Part 2\"\nauthor: \"David Chiam & Liu Chih Yuan\"\ndescription: \"\"\ndate: \"10 May 2025\"\ndate-modified: \"last-modified\"\nformat: html\neditor: visual\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  message: false\n  freeze: auto\n---\n\n\n\n\n\n::: callout-note\n# Commenting on David Chiam's EDA 3.2\n\nLink: [David Chiam Netlify](https://isss608-davidchiam.netlify.app/take-home_ex/take-home_ex01/take-home_ex01)\n:::\n\n# **1. Overview**\n\n## **Setting the scene**\n\nA local online media company that publishes daily content on digital platforms is planning to release an article on **demographic structures and distribution of Singapore in 2024**.\n\n## **The task**\n\nAssuming the role of the graphical editor of the media company, the task was to prepareÂ **at most three data visualisation**Â for the exercise.\n\nHence in this exercise, I curated three key visualisations as part of dats exploration:\n\n-   **Generational Distribution by Region:** A paired bar chart highlights both absolute and relative generational makeup across Singaporeâ€™s five planning regions, revealing the Central and East as home to proportionally older populations.\n-   **Age Demographics by Planning Area:** A boxplot with overlaid generation bands showcases median age and interquartile ranges, emphasising regions with mature population profiles like Central and West Singapore.\n-   **Top Planning Areas by Age Band:** A set of ranked bar charts and accompanying pie charts depict the top 15 planning areas by population size in three age segmentsâ€”youth (0â€“24), adults (25â€“54), and seniors (55+). These are complemented with gender breakdowns to visualise demographic imbalances.\n\n# **2. Getting started, Data Loading and Preparation**\n\nThis section documents the process of preparing the dataset for analysis and visualization. It covers the loading of R packages, initial inspection of the dataset, and the necessary wrangling and transformation steps applied.\n\n### **2.1 Load required packages ðŸ“¦**\n\nBefore importing the data, we load several R packages from the **tidyverse** ecosystem and supporting libraries for data wrangling and visualization. These packages streamline data processing and produce publication-ready plots using `ggplot2`. This setup ensure that we have both the flexibility and power to craft expressive, publication-quality demographic visualizations for the report.\n\nðŸ“Œ **Summary of Package Roles**\n\n| Library | Description |\n|----|----|\n| [**tidyverse**](https://www.tidyverse.org/) | A collection of core packages designed for data science, used extensively for data preparation and wrangling |\n| [**knitr**](https://yihui.org/knitr/) | Generates dynamic R markdown or Quarto reports |\n| [**patchwork**](https://patchwork.data-imaginist.com/) | Combine multiple ggplots into a single layout |\n| [**ggthemes**](https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/) | Provides extra themes (e.g. economist, wsj) |\n| [**scales**](https://scales.r-lib.org/) | For data/axes label formatting and annotations for ggplot2 |\n| [**ggtext**](https://wilkelab.org/ggtext/) | Supports improved and rich text rendering for ggplot2 |\n| [**ggalt**](https://yonicd.github.io/ggalt/) | A compendium of â€˜geomsâ€™, â€˜coordsâ€™, â€˜statsâ€™, scales and fonts for ggplots2 |\n| [**ggridges**](https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html) | For ridgeline plots that create the impression of a mountain range. They can be useful for visualising changes in distributions over time or space. |\n| [**ggpubr**](https://github.com/kassambara/ggpubr) | For publication-ready plots. |\n| [**ggextra**](https://github.com/daattali/ggExtra) | For adding marginal plots to ggplot2 |\n| [**cowplot**](https://github.com/wilkelab/cowplot) | Provides precise figure alignment and plot annotation |\n| [**ggnewscale**](https://eliocamp.github.io/ggnewscale/) | Enables multiple fill/colour scales in a single plot. For defining scales in ggplot2. |\n| ggrepel |  |\n\nWe load the following R packages using the `pacman::p_load()` :\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(\n  tidyverse,     # Core data manipulation and ggplot2 plotting\n  knitr,         # Dynamic report generation and rendering\n  patchwork,     # Combines multiple ggplot2 plots\n  ggthemes,      # Additional themes and visual styles\n  scales,        # Formatting axes, scales, and labels\n  ggtext,        # Rich text formatting in ggplot titles/labels\n  ggalt,         # Dumbbell, lollipop, and other advanced geoms\n  ggridges,      # Ridgeline plots to visualize distributions\n  ggpubr,        # Publication-ready ggplot2 enhancements\n  ggExtra,       # Marginal plots for added insight\n  cowplot,       # Publication-quality figure alignment\n  ggnewscale,    # Allows multiple color/fill scales in one ggplot\n  ggrepel        # Allows\n)\n```\n:::\n\n\n\n\n\n### **2.2** Loading the Data and Taking a Glimpse of the Dataset **ðŸ“‚**\n\nThe dataset, *Singapore Residents by Planning Area / Subzone, Single Year of Age and Sex, June 2024*, published by the [Department of Statistics, Singapore (DOS)](https://www.singstat.gov.sg/) was loaded using the `read_csv()` function from the `readr` package in the tidyverse collection.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the dataset\ndf <- read_csv(\"data/respopagesex2024.csv\")\n```\n:::\n\n\n\n\n\nThe dataset contains **60,424 rows** and **6 columns**. Each row represents the count of residents for a specific combination of planning area, subzone, age, sex, and year.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 60,424\nColumns: 6\n$ PA   <chr> \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kâ€¦\n$ SZ   <chr> \"Ang Mo Kio Town Centre\", \"Ang Mo Kio Town Centre\", \"Ang Mo Kio Tâ€¦\n$ Age  <chr> \"0\", \"0\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", \"4\", \"4\", \"5\", \"5\", \"6\", â€¦\n$ Sex  <chr> \"Males\", \"Females\", \"Males\", \"Females\", \"Males\", \"Females\", \"Maleâ€¦\n$ Pop  <dbl> 10, 10, 10, 10, 10, 10, 10, 10, 30, 10, 20, 10, 20, 30, 30, 10, 3â€¦\n$ Time <dbl> 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024,â€¦\n```\n\n\n:::\n:::\n\n\n\n\n\nðŸ§¾ **Variable Descriptions**\n\n| Column | Type | Description |\n|----|----|----|\n| `PA` | Categorical | Planning Area (e.g., Ang Mo Kio, Bedok) |\n| `SZ` | Categorical | Subzone within each Planning Area |\n| `Age` | Categorical (to be converted) | Age in single years (e.g., 0â€“100+) |\n| `Sex` | Categorical | Gender: Male / Female |\n| `Pop` | Continuous (Integer) | Number of residents (rounded to nearest 10) |\n| `Time` | Identifier / Constant | Time period (always 2024 in this dataset) |\n\n### **2.3** **Wrangling, Cleaning & Transformation ðŸ§¹**\n\nTo ensure the data is ready for exploratory visualization and demographic analysis, a series of wrangling and transformation steps are applied. These steps are logically grouped and reusable across multiple visualization tasks.\n\n#### âœ… Convert **`Age`** to Integer\n\nThe `Age` column is stored as a character string (e.g., `\"100+\"`), which can prevent proper sorting, numeric comparisons, and calculations. I converted it to an integer, coercing `\"100+\"` to `100`, and remove any missing or malformed entries.\n\nThis step ensures that age values are usable in:\n\n-   Population pyramids\n-   Median age calculations\n-   Age band groupings\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>%\n  mutate(Age = as.integer(Age)) %>%  # Convert to numeric (100+ becomes NA)\n  drop_na(Age)                       # Remove missing values caused by conversion\n```\n:::\n\n\n\n\n\n#### âœ… Create `AgeBand` for Grouped Analysis\n\nWorking with 101 separate age values (0â€“100) may clutter visualizations and dilute insight. Therefore, I bin the ages into meaningful age bands for easier demographic comparison and comparative visualization. These age bands are especially helpful for:\n\n-   Grouped bar charts\n-   Age structure comparisons across planning areas\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>%\n  mutate(AgeBand = cut(Age,\n    breaks = c(0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55,\n               60, 65, 70, 75, 80, 85, 90, 95, 100, Inf),\n    labels = c(\"0-4\", \"5-9\", \"10-14\", \"15-19\", \"20-24\", \"25-29\",\n               \"30-34\", \"35-39\", \"40-44\", \"45-49\", \"50-54\",\n               \"55-59\", \"60-64\", \"65-69\", \"70-74\", \"75-79\",\n               \"80-84\", \"85-89\", \"90-94\", \"95-99\", \"100+\"),\n    right = FALSE))\n```\n:::\n\n\n\n\n\n#### âœ… Aggregate for Exploratory Plots & Key Insights\n\nThe data was group by Planning Area, Sex, and Age Band to prepare for visual comparisons across demographic segments. Using the code below, we can compute the **aggregated population totals** across:\n\n-   **Age Ã— Sex**: for national pyramids\n-   **Planning Area**: for ranking and spatial comparisons\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# For population pyramid (Age-Sex)\npyramid_data <- df %>%\n  group_by(Age, Sex) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\")\n\n# For top 5 planning areas\ntop5_pa <- df %>%\n  group_by(PA) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  slice_max(order_by = Pop, n = 5)\n```\n:::\n\n\n\n\n\n#### âœ… Add Region Classification Based on Planning Area\n\nTo enhance geographical analysis, we classify each Planning Area (`PA`) into one of Singaporeâ€™s five official regions (1) Central, (2) East, (3) North, (4) North-East, and (5) West. This grouping follows Singaporeâ€™s **Urban Redevelopment Authority (URA) Master Plan** and allows for cleaner regional comparisons, faceted plots, and high-level demographic summaries.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>%\n  mutate(\n    PA = str_trim(str_to_upper(PA)),\n    Region = case_when(\n      PA %in% c(\"BISHAN\", \"BUKIT MERAH\", \"BUKIT TIMAH\", \"CENTRAL AREA\", \"DOWNTOWN CORE\",\n                \"GEYLANG\", \"KALLANG\", \"MARINA EAST\", \"MARINA SOUTH\", \"MUSEUM\", \"NEWTON\",\n                \"NOVENA\", \"ORCHARD\", \"OUTRAM\", \"PAYA LEBAR\", \"QUEENSTOWN\", \"RIVER VALLEY\",\n                \"ROCHOR\", \"SINGAPORE RIVER\", \"SOUTHERN ISLANDS\", \"STRAITS VIEW\", \"TANGLIN\",\n                \"TOA PAYOH\", \"MARINE PARADE\") ~ \"Central\",\n      PA %in% c(\"BEDOK\", \"CHANGI\", \"CHANGI BAY\", \"PASIR RIS\", \"TAMPINES\") ~ \"East\",\n      PA %in% c(\"CENTRAL WATER CATCHMENT\", \"MANDAI\", \"SEMBABWANG\", \"SIMPANG\",\n                \"SUNGEI KADUT\", \"WOODLANDS\", \"YISHUN\", \"SEMBAWANG\") ~ \"North\",\n      PA %in% c(\"ANG MO KIO\", \"HOUGANG\", \"NORTH-EASTERN ISLANDS\", \"PUNGGOL\",\n                \"SELETAR\", \"SENGKANG\", \"SERANGOON\") ~ \"North-East\",\n      PA %in% c(\"BOON LAY\", \"BUKIT BATOK\", \"BUKIT PANJANG\", \"CHOA CHU KANG\",\n                \"CLEMENTI\", \"JURONG EAST\", \"JURONG WEST\", \"LIM CHU KANG\",\n                \"PIONEER\", \"TENGAH\", \"TUAS\", \"WESTERN ISLANDS\",\n                \"WESTERN WATER CATCHMENT\") ~ \"West\",\n      TRUE ~ NA_character_\n    )\n  )\n```\n:::\n\n\n\n\n\n#### âœ… Compute the Weighted Median Age\n\nAs the simple median of the `Age` column would be misleading, as it treats each age as equally populated. Instead, we calculate a **weighted median** that reflects **actual population counts** per age to give a statistically more accurate median age for the **entire Singapore resident population**..\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_median <- df %>%\n  arrange(Age) %>%\n  mutate(\n    cum_pop = cumsum(Pop),\n    total_pop = sum(Pop)\n  ) %>%\n  filter(cum_pop >= total_pop / 2) %>%\n  slice(1)\n\nmedian_age <- df_median$Age\n```\n:::\n\n\n\n\n\n#### âœ… Generation Band Mapping\n\nCreate Generation bands based on categories.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>%\n  mutate(\n    GenerationBand = case_when(\n      Age <= 24 ~ \"Alpha & Gen Z (0â€“24)\",\n      Age <= 34 ~ \"Young Adults (25â€“34)\",\n      Age <= 54 ~ \"Working Adults (35â€“54)\",\n      Age <= 64 ~ \"Silver Generation (55â€“64)\",\n      Age <= 74 ~ \"Merdeka Generation (65â€“74)\",\n      TRUE ~ \"Pioneer Generation (75+)\"\n    ),\n    GenerationBand = factor(GenerationBand, levels = c(\n      \"Alpha & Gen Z (0â€“24)\", \"Young Adults (25â€“34)\", \"Working Adults (35â€“54)\",\n      \"Silver Generation (55â€“64)\", \"Merdeka Generation (65â€“74)\", \"Pioneer Generation (75+)\"\n    ))\n  )\n```\n:::\n\n\n\n\n\n#### âœ… Create Aggregated Summary Table\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_summary <- df %>%\n  group_by(Region, PA, AgeBand, Sex) %>%\n  summarise(Total = sum(Pop), .groups = \"drop\")\n```\n:::\n\n\n\n\n\n# 3. Exploratory Data Analysis (EDA) ðŸ“Š\n\n### ðŸ” **3.2 How are age groups distributed across the five regions?**\n\n**Goal**: To explore the demographic composition across Singaporeâ€™s five regions using meaningful generational groupings, this visualisation compares the proportion of residents by age cohort. It addresses how youth, workforce, and senior populations differ geographically.\n\n**Method**: Using the 2024 DOS dataset, residents are grouped by region and classified into six age bands based on Singaporeâ€™s social-policy generations: *Alpha & Gen Z (0â€“24yo), Young Adults (25â€“34yo), Working Adults (35â€“54yo), Silver Generation (55â€“64yo), Merdeka Generation (65â€“74yo), and Pioneer Generation (\\>75yo)*. Percentages are calculated within each region and plotted using a colour-safe, perceptually consistent palette to enhance visual clarity and accessibility.\n\n::: panel-tabset\n## The Combined Plot\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](TakeHome_Ex01B_files/figure-html/unnamed-chunk-11-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](TakeHome_Ex01B_files/figure-html/unnamed-chunk-12-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n\\^*For the visuals on the Age Distribution Across Regions, the plot's background has been coloured to show the Generation Bands across age spectrum of the X-axis.*\n\n\\>\\>\\> *Toggle to the other tabs to view the clearer version of each plot.*\n\nThis visualisation examines the generational distribution of Singaporeâ€™s resident population across the five main planning regions, using both absolute population counts and proportional shares. The left panel highlights the total number of residents in each generation, while the right panel normalises these figures to show the internal demographic mix within each region.\n\n## Population Count by Generation\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](TakeHome_Ex01B_files/figure-html/unnamed-chunk-13-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n## Population Percentage by Generation\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](TakeHome_Ex01B_files/figure-html/unnamed-chunk-14-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n## Bar Plot of Age Distribution across Regions\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](TakeHome_Ex01B_files/figure-html/unnamed-chunk-15-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n## The Code Chunk\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data prep with generation bands\ndf_generations <- df %>%\n  mutate(\n    AgeGroup = case_when(\n      Age <= 24 ~ \"Alpha & Gen Z (0-24)\",\n      Age <= 34 ~ \"Young Adults (25-34)\",\n      Age <= 54 ~ \"Working Adults (35-54)\",\n      Age <= 64 ~ \"Silver Generation (55-64)\",\n      Age <= 74 ~ \"Merdeka Generation (65-74)\",\n      TRUE ~ \"Pioneer Generation (>75)\"\n    ),\n    AgeGroup = factor(AgeGroup, levels = c(\n      \"Alpha & Gen Z (0-24)\",\n      \"Young Adults (25-34)\",\n      \"Working Adults (35-54)\",\n      \"Silver Generation (55-64)\",\n      \"Merdeka Generation (65-74)\",\n      \"Pioneer Generation (>75)\"\n    ))\n  ) %>%\n  group_by(Region, AgeGroup) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  group_by(Region) %>%\n  mutate(Perc = Pop / sum(Pop) * 100)\n\n# --- Plot A: Count-based ---\nplot_counts <- ggplot(df_generations, aes(x = Region, y = Pop, fill = AgeGroup)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = comma(Pop)), position = position_stack(vjust = 0.5),\n            size = 2.2, color = \"black\") +\n  scale_fill_brewer(palette = \"Set3\") +\n  scale_y_continuous(labels = NULL, breaks = NULL) +  # Remove y-axis labels\n  labs(\n    title = \"Population Count by Generation\",\n    subtitle = \"Total residents of each generation by region\",\n    x = NULL, y = NULL,\n    fill = NULL\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    plot.subtitle = element_text(size = 8)\n  )\n\n\n# --- Plot B: Percentage-based ---\nplot_perc <- ggplot(df_generations, aes(x = Region, y = Perc, fill = AgeGroup)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = paste0(round(Perc, 1), \"%\")),\n            position = position_stack(vjust = 0.5), size =2.2, color = \"black\") +\n  scale_fill_brewer(palette = \"Set3\") +\n  scale_y_continuous(labels = NULL, breaks = NULL) +  # Remove y-axis labels\n  labs(\n    title = \"Population Share by Generation\",\n    subtitle = \"Proportion of each generation by region\",\n    x = NULL, y = NULL,\n    fill = NULL\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    plot.subtitle = element_text(size = 8),\n    legend.text = element_text(size = rel(0.7))  # 30% smaller\n  )\n\n# Combine plots\nplot_counts + plot_perc + plot_layout(guides = \"collect\") & \n  theme(legend.position = \"bottom\", legend.text = element_text(size = rel(0.7)))\n```\n:::\n\n\n\n\n:::\n\n::: How-Does-it-Work\n[<strong>Insights gleamed from these plots in section 3.2</strong>]{style=\"font-size: 30px; vertical-align: middle;\"}\n\nThese visualisations compares Singaporeâ€™s resident population by generation across the five main planning regions, using both absolute ounts (left panel) and proportional shares (right panel). **Working adults (ages 35â€“54)** form the largest demographic in all regions, especially in the **East and North**. However, the **Central region** stands out for its **higher concentration of older residents**, particularly from the **Merdeka and Pioneer generations**, both in absolute numbers and as a proportion of its population.\n\nConversely, the **North-East and West** regions show a higher share of **younger residents under 35**, reflecting newer housing developments and growing family clusters. While younger generations are more evenly spread in these regions, older cohorts are disproportionately concentrated in the **Central, East, and West**.\n\nSupporting this, the **boxplots and age summaries** reveal **higher median ages** and **tighter interquartile ranges** in these ageing regionsâ€”highlighting a more mature demographic profile that warrants targeted **urban planning, healthcare, and ageing-in-place strategies**.\n:::\n\n# 4. Comments by Liu Chih Yuan\n\n## Good points\n\n1.  Clear Breakdown by Generation\n    -   The stacked bar plots clearly distinguished generations using multiple colors and labels, making it easy to digest\n2.  Good Use of Facets (Counts vs Percentage)\n    -   Shows both raw counts and percentages side by side for good comparison\n3.  Boxplot with Annotated Summary Stats\n    -   Labels on age distribution boxplot aids for easier interpretation\n\n## Improvements\n\n1.  Font Size Too Small for Lables\n    -   *Issue:* text is hard to read\n\n    -   **Fix:** increase font size to improve readability\n2.  Color Palette Not Very Readable\n    -   *Issue:* hard to read and not colorblind friendly\n\n    -   **Fix:** use color palette such as `viridis` or `OkabeIto`\n3.  Overcrowded Text in Stacked Bars\n    -   *Issue:* readability of text inside stacked bars are not good\n\n    -   **Fix:** display labels for only larger segments\n\n## Revised Version of EDA 3.2\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](TakeHome_Ex01B_files/figure-html/unnamed-chunk-17-1.png){width=1536}\n:::\n:::\n",
    "supporting": [
      "TakeHome_Ex01B_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}